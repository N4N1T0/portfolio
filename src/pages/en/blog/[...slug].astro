---
import Layout from '@/layouts/Layout.astro'
import { getPosts } from '@/lib'
import { generateJsonLDForBlogPost } from '@/components/shared/jsonLD'
import Body from '@/components/blog/Body.astro'
import Courtain from '@/components/shared/Courtain.astro'

export async function getStaticPaths() {
  const posts = await getPosts('en')
  return posts.map((post) => ({
    params: { slug: post.id.replace('/', '') },
    props: post
  }))
}

const post = Astro.props
const slug = Astro.params.slug
export const prerender = true

if (!slug || !post) {
  return new Response(null, {
    status: 404,
    statusText: 'Not found'
  })
}

const ld = await generateJsonLDForBlogPost(post, 'en')
---

<Layout
  description={post.data.excerpt}
  title={post.data.title}
  image={post.data.image.src}
  label='Blog'
  link='/en/blog'
  ld={ld}
>
  <Body blog={post} />
  <Courtain />
</Layout>
